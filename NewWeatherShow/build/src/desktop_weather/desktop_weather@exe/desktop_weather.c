/* desktop_weather.c generated by valac 0.40.4, the Vala compiler
 * generated from desktop_weather.vala, do not modify */



#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <gio/gio.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <gdk/gdk.h>
#include <cairo.h>


#define TYPE_DESKTOP_WEATHER (desktop_weather_get_type ())
#define DESKTOP_WEATHER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_DESKTOP_WEATHER, DesktopWeather))
#define DESKTOP_WEATHER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_DESKTOP_WEATHER, DesktopWeatherClass))
#define IS_DESKTOP_WEATHER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_DESKTOP_WEATHER))
#define IS_DESKTOP_WEATHER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_DESKTOP_WEATHER))
#define DESKTOP_WEATHER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_DESKTOP_WEATHER, DesktopWeatherClass))

typedef struct _DesktopWeather DesktopWeather;
typedef struct _DesktopWeatherClass DesktopWeatherClass;
typedef struct _DesktopWeatherPrivate DesktopWeatherPrivate;
enum  {
	DESKTOP_WEATHER_0_PROPERTY,
	DESKTOP_WEATHER_NUM_PROPERTIES
};
static GParamSpec* desktop_weather_properties[DESKTOP_WEATHER_NUM_PROPERTIES];
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _g_regex_unref0(var) ((var == NULL) ? NULL : (var = (g_regex_unref (var), NULL)))
#define _g_dir_close0(var) ((var == NULL) ? NULL : (var = (g_dir_close (var), NULL)))

struct _DesktopWeather {
	GtkWindow parent_instance;
	DesktopWeatherPrivate * priv;
};

struct _DesktopWeatherClass {
	GtkWindowClass parent_class;
};

struct _DesktopWeatherPrivate {
	GFile* datasrc;
	GFileMonitor* monitor;
	GtkGrid* maingrid;
	GtkLabel* locationlabel;
	GtkLabel* weatherlabel;
	GSettings* desktop_settings;
	gchar* css_data;
	gchar* css_template;
	GtkCssProvider* css_provider;
	gdouble new_transp;
	GdkPixbuf** iconpixbufs_1;
	gint iconpixbufs_1_length1;
	gint _iconpixbufs_1_size_;
	GdkPixbuf** iconpixbufs_2;
	gint iconpixbufs_2_length1;
	gint _iconpixbufs_2_size_;
	GdkPixbuf** iconpixbufs_3;
	gint iconpixbufs_3_length1;
	gint _iconpixbufs_3_size_;
	gint currscale;
	gchar** iconnames;
	gint iconnames_length1;
	gint _iconnames_size_;
	GtkImage* weather_image;
};


static gpointer desktop_weather_parent_class = NULL;

GType desktop_weather_get_type (void) G_GNUC_CONST;
#define DESKTOP_WEATHER_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), TYPE_DESKTOP_WEATHER, DesktopWeatherPrivate))
DesktopWeather* desktop_weather_new (void);
DesktopWeather* desktop_weather_construct (GType object_type);
static gboolean __lambda4_ (DesktopWeather* self);
static gboolean desktop_weather_check_onapplet (DesktopWeather* self,
                                         const gchar* path,
                                         const gchar* applet_name);
static gboolean ___lambda4__gsource_func (gpointer self);
static void desktop_weather_get_icondata (DesktopWeather* self);
static void desktop_weather_check_res (DesktopWeather* self);
static GSettings* desktop_weather_get_settings (DesktopWeather* self,
                                         const gchar* path);
static void desktop_weather_set_windowpos (DesktopWeather* self);
static void _desktop_weather_set_windowpos_g_settings_changed (GSettings* _sender,
                                                        const gchar* key,
                                                        gpointer self);
static void __lambda5_ (DesktopWeather* self);
static void ___lambda5__g_settings_changed (GSettings* _sender,
                                     const gchar* key,
                                     gpointer self);
static void __lambda6_ (DesktopWeather* self);
static void desktop_weather_update_style (DesktopWeather* self);
static void ___lambda6__g_settings_changed (GSettings* _sender,
                                     const gchar* key,
                                     gpointer self);
static void __lambda7_ (DesktopWeather* self);
static void ___lambda7__g_settings_changed (GSettings* _sender,
                                     const gchar* key,
                                     gpointer self);
static void __lambda8_ (DesktopWeather* self);
static void ___lambda8__g_settings_changed (GSettings* _sender,
                                     const gchar* key,
                                     gpointer self);
static gchar* desktop_weather_get_css (DesktopWeather* self);
static gboolean desktop_weather_on_draw (DesktopWeather* self,
                                  GtkWidget* da,
                                  cairo_t* ctx);
static gboolean _desktop_weather_on_draw_gtk_widget_draw (GtkWidget* _sender,
                                                   cairo_t* cr,
                                                   gpointer self);
static void desktop_weather_update_content (DesktopWeather* self);
static void _desktop_weather_update_content_g_file_monitor_changed (GFileMonitor* _sender,
                                                             GFile* file,
                                                             GFile* other_file,
                                                             GFileMonitorEvent event_type,
                                                             gpointer self);
static gint desktop_weather_get_stringindex (DesktopWeather* self,
                                      const gchar* s,
                                      gchar** arr,
                                      int arr_length1);
static GdkPixbuf** _vala_array_dup1 (GdkPixbuf** self,
                              int length);
static GdkPixbuf** _vala_array_dup2 (GdkPixbuf** self,
                              int length);
static GdkPixbuf** _vala_array_dup3 (GdkPixbuf** self,
                              int length);
static void _vala_array_add1 (gchar** * array,
                       int* length,
                       int* size,
                       gchar* value);
static gchar* desktop_weather_find_mappedid (DesktopWeather* self,
                                      const gchar* icon_id);
static void _vala_array_add2 (gchar** * array,
                       int* length,
                       int* size,
                       gchar* value);
static void _vala_array_add3 (GdkPixbuf** * array,
                       int* length,
                       int* size,
                       GdkPixbuf* value);
static void _vala_array_add4 (GdkPixbuf** * array,
                       int* length,
                       int* size,
                       GdkPixbuf* value);
static void _vala_array_add5 (GdkPixbuf** * array,
                       int* length,
                       int* size,
                       GdkPixbuf* value);
void desktop_weather_main (gchar** args,
                           int args_length1);
static void _gtk_main_quit_gtk_widget_destroy (GtkWidget* _sender,
                                        gpointer self);
static void desktop_weather_finalize (GObject * obj);
static void _vala_array_destroy (gpointer array,
                          gint array_length,
                          GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array,
                       gint array_length,
                       GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);


static gboolean
__lambda4_ (DesktopWeather* self)
{
	gboolean result = FALSE;
	gboolean active = FALSE;
	gboolean _tmp0_;
	active = desktop_weather_check_onapplet (self, "/com/solus-project/budgie-panel/applets/", "WeatherShow");
	_tmp0_ = active;
	if (_tmp0_ != TRUE) {
		gtk_main_quit ();
	}
	result = TRUE;
	return result;
}


static gboolean
___lambda4__gsource_func (gpointer self)
{
	gboolean result;
	result = __lambda4_ ((DesktopWeather*) self);
	return result;
}


static void
_desktop_weather_set_windowpos_g_settings_changed (GSettings* _sender,
                                                   const gchar* key,
                                                   gpointer self)
{
	desktop_weather_set_windowpos ((DesktopWeather*) self);
}


static void
__lambda5_ (DesktopWeather* self)
{
	gboolean newval = FALSE;
	GSettings* _tmp0_;
	gboolean _tmp1_;
	_tmp0_ = self->priv->desktop_settings;
	newval = g_settings_get_boolean (_tmp0_, "desktopweather");
	_tmp1_ = newval;
	if (_tmp1_ == FALSE) {
		gtk_main_quit ();
	}
}


static void
___lambda5__g_settings_changed (GSettings* _sender,
                                const gchar* key,
                                gpointer self)
{
	__lambda5_ ((DesktopWeather*) self);
}


static void
__lambda6_ (DesktopWeather* self)
{
	desktop_weather_update_style (self);
}


static void
___lambda6__g_settings_changed (GSettings* _sender,
                                const gchar* key,
                                gpointer self)
{
	__lambda6_ ((DesktopWeather*) self);
}


static gchar*
double_to_string (gdouble self)
{
	gchar* result = NULL;
	gchar* _tmp0_;
	gchar* _tmp1_;
	gint _tmp1__length1;
	const gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_;
	_tmp0_ = g_new0 (gchar, G_ASCII_DTOSTR_BUF_SIZE);
	_tmp1_ = _tmp0_;
	_tmp1__length1 = G_ASCII_DTOSTR_BUF_SIZE;
	_tmp2_ = g_ascii_dtostr (_tmp1_, G_ASCII_DTOSTR_BUF_SIZE, self);
	_tmp3_ = g_strdup (_tmp2_);
	_tmp4_ = _tmp3_;
	_tmp1_ = (g_free (_tmp1_), NULL);
	result = _tmp4_;
	return result;
}


static void
__lambda7_ (DesktopWeather* self)
{
	gint transparency = 0;
	GSettings* _tmp0_;
	gdouble _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_;
	gchar* _tmp5_;
	_tmp0_ = self->priv->desktop_settings;
	transparency = 100 - g_settings_get_int (_tmp0_, "transparency");
	self->priv->new_transp = transparency / 100.0;
	_tmp1_ = self->priv->new_transp;
	_tmp2_ = double_to_string (_tmp1_);
	_tmp3_ = _tmp2_;
	_tmp4_ = g_strconcat ("ex: ", _tmp3_, "\n", NULL);
	_tmp5_ = _tmp4_;
	g_print ("%s", _tmp5_);
	_g_free0 (_tmp5_);
	_g_free0 (_tmp3_);
	gtk_widget_queue_draw ((GtkWidget*) self);
}


static void
___lambda7__g_settings_changed (GSettings* _sender,
                                const gchar* key,
                                gpointer self)
{
	__lambda7_ ((DesktopWeather*) self);
}


static void
__lambda8_ (DesktopWeather* self)
{
	gboolean newval = FALSE;
	GSettings* _tmp0_;
	gboolean _tmp1_;
	_tmp0_ = self->priv->desktop_settings;
	newval = g_settings_get_boolean (_tmp0_, "desktopweather");
	_tmp1_ = newval;
	if (_tmp1_ == FALSE) {
		gtk_main_quit ();
	}
}


static void
___lambda8__g_settings_changed (GSettings* _sender,
                                const gchar* key,
                                gpointer self)
{
	__lambda8_ ((DesktopWeather*) self);
}


static gpointer
_g_object_ref0 (gpointer self)
{
	return self ? g_object_ref (self) : NULL;
}


static gboolean
_desktop_weather_on_draw_gtk_widget_draw (GtkWidget* _sender,
                                          cairo_t* cr,
                                          gpointer self)
{
	gboolean result;
	result = desktop_weather_on_draw ((DesktopWeather*) self, _sender, cr);
	return result;
}


static void
_desktop_weather_update_content_g_file_monitor_changed (GFileMonitor* _sender,
                                                        GFile* file,
                                                        GFile* other_file,
                                                        GFileMonitorEvent event_type,
                                                        gpointer self)
{
	desktop_weather_update_content ((DesktopWeather*) self);
}


DesktopWeather*
desktop_weather_construct (GType object_type)
{
	DesktopWeather * self = NULL;
	gchar* _tmp0_;
	GSettings* _tmp1_;
	GSettings* _tmp2_;
	GSettings* _tmp3_;
	GSettings* _tmp4_;
	GSettings* _tmp5_;
	GSettings* _tmp6_;
	GSettings* _tmp7_;
	gchar* _tmp8_;
	const gchar* _tmp9_;
	gchar* _tmp10_;
	gchar* _tmp11_;
	gchar* _tmp12_;
	gchar* _tmp13_;
	gint transparency = 0;
	GSettings* _tmp14_;
	gint _tmp15_;
	GdkScreen* screen = NULL;
	GdkScreen* _tmp16_;
	GdkScreen* _tmp17_;
	GdkVisual* visual = NULL;
	GdkScreen* _tmp18_;
	GdkVisual* _tmp19_;
	GdkVisual* _tmp20_;
	GdkVisual* _tmp21_;
	gchar* username = NULL;
	const gchar* _tmp22_;
	gchar* _tmp23_;
	gchar* src = NULL;
	const gchar* _tmp24_;
	gchar* _tmp25_;
	const gchar* _tmp26_;
	GFile* _tmp27_;
	GtkGrid* _tmp28_;
	GtkGrid* _tmp29_;
	GtkGrid* _tmp30_;
	GtkLabel* _tmp31_;
	GtkLabel* _tmp32_;
	GtkGrid* _tmp33_;
	GtkLabel* _tmp34_;
	GtkLabel* _tmp35_;
	GtkGrid* _tmp36_;
	GtkLabel* _tmp37_;
	GtkLabel* _tmp38_;
	GtkLabel* _tmp39_;
	GtkLabel* _tmp40_;
	GtkCssProvider* _tmp41_;
	GtkCssProvider* _tmp42_;
	const gchar* _tmp43_;
	GdkScreen* _tmp44_;
	GtkCssProvider* _tmp45_;
	GtkLabel* _tmp46_;
	GtkStyleContext* _tmp47_;
	GtkLabel* _tmp48_;
	GtkStyleContext* _tmp49_;
	GtkGrid* _tmp50_;
	GtkLabel* _tmp51_;
	GtkGrid* _tmp52_;
	GtkLabel* _tmp53_;
	GtkImage* _tmp54_;
	GtkGrid* _tmp55_;
	GtkImage* _tmp56_;
	GFileMonitor* _tmp57_ = NULL;
	GFile* _tmp58_;
	GFileMonitor* _tmp59_;
	GFileMonitor* _tmp60_;
	GFileMonitor* _tmp61_;
	GError * _inner_error_ = NULL;
	self = (DesktopWeather*) g_object_new (object_type, NULL);
	g_timeout_add_seconds_full (G_PRIORITY_DEFAULT, (guint) 5, ___lambda4__gsource_func, g_object_ref (self), g_object_unref);
	gtk_window_set_decorated ((GtkWindow*) self, FALSE);
	gtk_window_set_type_hint ((GtkWindow*) self, GDK_WINDOW_TYPE_HINT_DESKTOP);
	self->priv->currscale = 1;
	desktop_weather_get_icondata (self);
	desktop_weather_check_res (self);
	_tmp0_ = g_strdup ("\n" \
"            .biglabel {\n" \
"                font-size: bigfontpx;\n" \
"                color: xxx-xxx-xxx;\n" \
"\n" \
"            }\n" \
"            .label {\n" \
"                font-size: smallfontpx;\n" \
"                color: xxx-xxx-xxx;\n" \
"            }\n" \
"            ");
	_g_free0 (self->priv->css_template);
	self->priv->css_template = _tmp0_;
	_tmp1_ = desktop_weather_get_settings (self, "org.ubuntubudgie.plugins.weathershow");
	_g_object_unref0 (self->priv->desktop_settings);
	self->priv->desktop_settings = _tmp1_;
	desktop_weather_set_windowpos (self);
	_tmp2_ = self->priv->desktop_settings;
	g_signal_connect_object (_tmp2_, "changed::xposition", (GCallback) _desktop_weather_set_windowpos_g_settings_changed, self, 0);
	_tmp3_ = self->priv->desktop_settings;
	g_signal_connect_object (_tmp3_, "changed::yposition", (GCallback) _desktop_weather_set_windowpos_g_settings_changed, self, 0);
	_tmp4_ = self->priv->desktop_settings;
	g_signal_connect_object (_tmp4_, "changed::desktopweather", (GCallback) ___lambda5__g_settings_changed, self, 0);
	_tmp5_ = self->priv->desktop_settings;
	g_signal_connect_object (_tmp5_, "changed::textcolor", (GCallback) ___lambda6__g_settings_changed, self, 0);
	_tmp6_ = self->priv->desktop_settings;
	g_signal_connect_object (_tmp6_, "changed::transparency", (GCallback) ___lambda7__g_settings_changed, self, 0);
	_tmp7_ = self->priv->desktop_settings;
	g_signal_connect_object (_tmp7_, "changed::desktopweather", (GCallback) ___lambda8__g_settings_changed, self, 0);
	_tmp8_ = desktop_weather_get_css (self);
	_g_free0 (self->priv->css_data);
	self->priv->css_data = _tmp8_;
	_tmp9_ = self->priv->css_data;
	_tmp10_ = g_strconcat ("css_data\n", _tmp9_, NULL);
	_tmp11_ = _tmp10_;
	_tmp12_ = g_strconcat (_tmp11_, "\n", NULL);
	_tmp13_ = _tmp12_;
	g_print ("%s", _tmp13_);
	_g_free0 (_tmp13_);
	_g_free0 (_tmp11_);
	_tmp14_ = self->priv->desktop_settings;
	transparency = 100 - g_settings_get_int (_tmp14_, "transparency");
	_tmp15_ = transparency;
	self->priv->new_transp = _tmp15_ / 100.0;
	_tmp16_ = gtk_window_get_screen ((GtkWindow*) self);
	_tmp17_ = _g_object_ref0 (_tmp16_);
	screen = _tmp17_;
	gtk_widget_set_app_paintable ((GtkWidget*) self, TRUE);
	_tmp18_ = screen;
	_tmp19_ = gdk_screen_get_rgba_visual (_tmp18_);
	_tmp20_ = _g_object_ref0 (_tmp19_);
	visual = _tmp20_;
	_tmp21_ = visual;
	gtk_widget_set_visual ((GtkWidget*) self, _tmp21_);
	g_signal_connect_object ((GtkWidget*) self, "draw", (GCallback) _desktop_weather_on_draw_gtk_widget_draw, self, 0);
	_tmp22_ = g_get_user_name ();
	_tmp23_ = g_strdup (_tmp22_);
	username = _tmp23_;
	_tmp24_ = username;
	_tmp25_ = g_strconcat ("/tmp/", _tmp24_, "_weatherdata", NULL);
	src = _tmp25_;
	_tmp26_ = src;
	_tmp27_ = g_file_new_for_path (_tmp26_);
	_g_object_unref0 (self->priv->datasrc);
	self->priv->datasrc = _tmp27_;
	_tmp28_ = (GtkGrid*) gtk_grid_new ();
	g_object_ref_sink (_tmp28_);
	_g_object_unref0 (self->priv->maingrid);
	self->priv->maingrid = _tmp28_;
	_tmp29_ = self->priv->maingrid;
	gtk_grid_set_column_spacing (_tmp29_, (guint) 20);
	_tmp30_ = self->priv->maingrid;
	_tmp31_ = (GtkLabel*) gtk_label_new (" ");
	g_object_ref_sink (_tmp31_);
	_tmp32_ = _tmp31_;
	gtk_grid_attach (_tmp30_, (GtkWidget*) _tmp32_, 0, 0, 1, 1);
	_g_object_unref0 (_tmp32_);
	_tmp33_ = self->priv->maingrid;
	_tmp34_ = (GtkLabel*) gtk_label_new (" ");
	g_object_ref_sink (_tmp34_);
	_tmp35_ = _tmp34_;
	gtk_grid_attach (_tmp33_, (GtkWidget*) _tmp35_, 10, 10, 1, 1);
	_g_object_unref0 (_tmp35_);
	_tmp36_ = self->priv->maingrid;
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) _tmp36_);
	_tmp37_ = (GtkLabel*) gtk_label_new ("");
	g_object_ref_sink (_tmp37_);
	_g_object_unref0 (self->priv->locationlabel);
	self->priv->locationlabel = _tmp37_;
	_tmp38_ = (GtkLabel*) gtk_label_new ("");
	g_object_ref_sink (_tmp38_);
	_g_object_unref0 (self->priv->weatherlabel);
	self->priv->weatherlabel = _tmp38_;
	_tmp39_ = self->priv->weatherlabel;
	gtk_label_set_xalign (_tmp39_, (gfloat) 0);
	_tmp40_ = self->priv->locationlabel;
	gtk_label_set_xalign (_tmp40_, (gfloat) 0);
	_tmp41_ = gtk_css_provider_new ();
	_g_object_unref0 (self->priv->css_provider);
	self->priv->css_provider = _tmp41_;
	_tmp42_ = self->priv->css_provider;
	_tmp43_ = self->priv->css_data;
	gtk_css_provider_load_from_data (_tmp42_, _tmp43_, (gssize) -1, &_inner_error_);
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		_g_free0 (src);
		_g_free0 (username);
		_g_object_unref0 (visual);
		_g_object_unref0 (screen);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
	_tmp44_ = screen;
	_tmp45_ = self->priv->css_provider;
	gtk_style_context_add_provider_for_screen (_tmp44_, (GtkStyleProvider*) _tmp45_, (guint) GTK_STYLE_PROVIDER_PRIORITY_USER);
	_tmp46_ = self->priv->weatherlabel;
	_tmp47_ = gtk_widget_get_style_context ((GtkWidget*) _tmp46_);
	gtk_style_context_add_class (_tmp47_, "label");
	_tmp48_ = self->priv->locationlabel;
	_tmp49_ = gtk_widget_get_style_context ((GtkWidget*) _tmp48_);
	gtk_style_context_add_class (_tmp49_, "biglabel");
	_tmp50_ = self->priv->maingrid;
	_tmp51_ = self->priv->locationlabel;
	gtk_grid_attach (_tmp50_, (GtkWidget*) _tmp51_, 2, 1, 1, 1);
	_tmp52_ = self->priv->maingrid;
	_tmp53_ = self->priv->weatherlabel;
	gtk_grid_attach (_tmp52_, (GtkWidget*) _tmp53_, 2, 2, 1, 1);
	_tmp54_ = (GtkImage*) gtk_image_new ();
	g_object_ref_sink (_tmp54_);
	_g_object_unref0 (self->priv->weather_image);
	self->priv->weather_image = _tmp54_;
	_tmp55_ = self->priv->maingrid;
	_tmp56_ = self->priv->weather_image;
	gtk_grid_attach (_tmp55_, (GtkWidget*) _tmp56_, 1, 1, 1, 5);
	_tmp58_ = self->priv->datasrc;
	_tmp59_ = g_file_monitor (_tmp58_, G_FILE_MONITOR_NONE, NULL, &_inner_error_);
	_tmp57_ = _tmp59_;
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		_g_free0 (src);
		_g_free0 (username);
		_g_object_unref0 (visual);
		_g_object_unref0 (screen);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
	_tmp60_ = _tmp57_;
	_tmp57_ = NULL;
	_g_object_unref0 (self->priv->monitor);
	self->priv->monitor = _tmp60_;
	_tmp61_ = self->priv->monitor;
	g_signal_connect_object (_tmp61_, "changed", (GCallback) _desktop_weather_update_content_g_file_monitor_changed, self, 0);
	desktop_weather_update_content (self);
	_g_object_unref0 (_tmp57_);
	_g_free0 (src);
	_g_free0 (username);
	_g_object_unref0 (visual);
	_g_object_unref0 (screen);
	return self;
}


DesktopWeather*
desktop_weather_new (void)
{
	return desktop_weather_construct (TYPE_DESKTOP_WEATHER);
}


static gboolean
string_contains (const gchar* self,
                 const gchar* needle)
{
	gboolean result = FALSE;
	gchar* _tmp0_;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (needle != NULL, FALSE);
	_tmp0_ = strstr ((gchar*) self, (gchar*) needle);
	result = _tmp0_ != NULL;
	return result;
}


static gboolean
desktop_weather_check_onapplet (DesktopWeather* self,
                                const gchar* path,
                                const gchar* applet_name)
{
	gboolean result = FALSE;
	gchar* cmd = NULL;
	gchar* _tmp0_;
	gchar* output = NULL;
	gboolean check = FALSE;
	const gchar* _tmp5_;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (path != NULL, FALSE);
	g_return_val_if_fail (applet_name != NULL, FALSE);
	_tmp0_ = g_strconcat ("dconf dump ", path, NULL);
	cmd = _tmp0_;
	{
		const gchar* _tmp1_;
		gchar* _tmp2_ = NULL;
		_tmp1_ = cmd;
		g_spawn_command_line_sync (_tmp1_, &_tmp2_, NULL, NULL, &_inner_error_);
		_g_free0 (output);
		output = _tmp2_;
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			gboolean _tmp3_ = FALSE;
			if (_inner_error_->domain == G_SPAWN_ERROR) {
				goto __catch0_g_spawn_error;
			}
			_g_free0 (output);
			_g_free0 (cmd);
			g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return _tmp3_;
		}
	}
	goto __finally0;
	__catch0_g_spawn_error:
	{
		GError* e = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		result = TRUE;
		_g_error_free0 (e);
		_g_free0 (output);
		_g_free0 (cmd);
		return result;
	}
	__finally0:
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		gboolean _tmp4_ = FALSE;
		_g_free0 (output);
		_g_free0 (cmd);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return _tmp4_;
	}
	_tmp5_ = output;
	check = string_contains (_tmp5_, applet_name);
	result = check;
	_g_free0 (output);
	_g_free0 (cmd);
	return result;
}


static gboolean
desktop_weather_on_draw (DesktopWeather* self,
                         GtkWidget* da,
                         cairo_t* ctx)
{
	gboolean result = FALSE;
	gdouble _tmp0_;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (da != NULL, FALSE);
	g_return_val_if_fail (ctx != NULL, FALSE);
	_tmp0_ = self->priv->new_transp;
	cairo_set_source_rgba (ctx, (gdouble) 0, (gdouble) 0, (gdouble) 0, _tmp0_);
	cairo_set_operator (ctx, CAIRO_OPERATOR_SOURCE);
	cairo_paint (ctx);
	cairo_set_operator (ctx, CAIRO_OPERATOR_OVER);
	result = FALSE;
	return result;
}


static void
desktop_weather_check_res (DesktopWeather* self)
{
	GdkMonitor* prim = NULL;
	GdkDisplay* _tmp0_;
	GdkMonitor* _tmp1_;
	GdkMonitor* _tmp2_;
	GdkRectangle geo = {0};
	GdkMonitor* _tmp3_;
	GdkRectangle _tmp4_ = {0};
	gint height = 0;
	GdkRectangle _tmp5_;
	gint _tmp6_;
	gint _tmp7_;
	g_return_if_fail (self != NULL);
	_tmp0_ = gdk_display_get_default ();
	_tmp1_ = gdk_display_get_primary_monitor (_tmp0_);
	_tmp2_ = _g_object_ref0 (_tmp1_);
	prim = _tmp2_;
	_tmp3_ = prim;
	gdk_monitor_get_geometry (_tmp3_, &_tmp4_);
	geo = _tmp4_;
	_tmp5_ = geo;
	_tmp6_ = _tmp5_.height;
	height = _tmp6_;
	_tmp7_ = height;
	if (_tmp7_ < 1000) {
		self->priv->currscale = 1;
	} else {
		gint _tmp8_;
		_tmp8_ = height;
		if (_tmp8_ < 1500) {
			self->priv->currscale = 2;
		} else {
			self->priv->currscale = 3;
		}
	}
	g_print ("%s", "scale: currscale\n");
	_g_object_unref0 (prim);
}


static void
desktop_weather_set_windowpos (DesktopWeather* self)
{
	gint xpos = 0;
	GSettings* _tmp0_;
	gint ypos = 0;
	GSettings* _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_;
	gchar* _tmp5_;
	gchar* _tmp6_;
	gchar* _tmp7_;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->desktop_settings;
	xpos = g_settings_get_int (_tmp0_, "xposition");
	_tmp1_ = self->priv->desktop_settings;
	ypos = g_settings_get_int (_tmp1_, "yposition");
	_tmp2_ = g_strdup_printf ("%i", xpos);
	_tmp3_ = _tmp2_;
	_tmp4_ = g_strdup_printf ("%i", ypos);
	_tmp5_ = _tmp4_;
	_tmp6_ = g_strconcat (_tmp3_, " ", _tmp5_, "\n", NULL);
	_tmp7_ = _tmp6_;
	g_print ("%s", _tmp7_);
	_g_free0 (_tmp7_);
	_g_free0 (_tmp5_);
	_g_free0 (_tmp3_);
	gtk_window_move ((GtkWindow*) self, xpos, ypos);
}


static GSettings*
desktop_weather_get_settings (DesktopWeather* self,
                              const gchar* path)
{
	GSettings* result = NULL;
	GSettings* settings = NULL;
	GSettings* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (path != NULL, NULL);
	_tmp0_ = g_settings_new (path);
	settings = _tmp0_;
	result = settings;
	return result;
}


static gchar*
string_replace (const gchar* self,
                const gchar* old,
                const gchar* replacement)
{
	gchar* result = NULL;
	gboolean _tmp0_ = FALSE;
	gboolean _tmp1_ = FALSE;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (old != NULL, NULL);
	g_return_val_if_fail (replacement != NULL, NULL);
	if ((*((gchar*) self)) == '\0') {
		_tmp1_ = TRUE;
	} else {
		_tmp1_ = (*((gchar*) old)) == '\0';
	}
	if (_tmp1_) {
		_tmp0_ = TRUE;
	} else {
		_tmp0_ = g_strcmp0 (old, replacement) == 0;
	}
	if (_tmp0_) {
		gchar* _tmp2_;
		_tmp2_ = g_strdup (self);
		result = _tmp2_;
		return result;
	}
	{
		GRegex* regex = NULL;
		gchar* _tmp3_;
		gchar* _tmp4_;
		GRegex* _tmp5_;
		GRegex* _tmp6_;
		gchar* _tmp7_ = NULL;
		GRegex* _tmp8_;
		gchar* _tmp9_;
		gchar* _tmp10_;
		_tmp3_ = g_regex_escape_string (old, -1);
		_tmp4_ = _tmp3_;
		_tmp5_ = g_regex_new (_tmp4_, 0, 0, &_inner_error_);
		_tmp6_ = _tmp5_;
		_g_free0 (_tmp4_);
		regex = _tmp6_;
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			if (_inner_error_->domain == G_REGEX_ERROR) {
				goto __catch1_g_regex_error;
			}
			g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return NULL;
		}
		_tmp8_ = regex;
		_tmp9_ = g_regex_replace_literal (_tmp8_, self, (gssize) -1, 0, replacement, 0, &_inner_error_);
		_tmp7_ = _tmp9_;
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			_g_regex_unref0 (regex);
			if (_inner_error_->domain == G_REGEX_ERROR) {
				goto __catch1_g_regex_error;
			}
			_g_regex_unref0 (regex);
			g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return NULL;
		}
		_tmp10_ = _tmp7_;
		_tmp7_ = NULL;
		result = _tmp10_;
		_g_free0 (_tmp7_);
		_g_regex_unref0 (regex);
		return result;
	}
	goto __finally1;
	__catch1_g_regex_error:
	{
		GError* e = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		g_assert_not_reached ();
		_g_error_free0 (e);
	}
	__finally1:
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
}


static gchar*
_vala_g_strjoinv (const gchar* separator,
                  gchar** str_array,
                  int str_array_length1)
{
	gchar* result = NULL;
	gboolean _tmp0_ = FALSE;
	if (separator == NULL) {
		separator = "";
	}
	if (str_array != NULL) {
		gboolean _tmp1_ = FALSE;
		if (str_array_length1 > 0) {
			_tmp1_ = TRUE;
		} else {
			gboolean _tmp2_ = FALSE;
			if (str_array_length1 == -1) {
				const gchar* _tmp3_;
				_tmp3_ = str_array[0];
				_tmp2_ = _tmp3_ != NULL;
			} else {
				_tmp2_ = FALSE;
			}
			_tmp1_ = _tmp2_;
		}
		_tmp0_ = _tmp1_;
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		gint i = 0;
		gsize len = 0UL;
		gint _tmp20_;
		gint _tmp22_;
		gint _tmp23_;
		gsize _tmp24_;
		gint _tmp25_;
		gint _tmp26_;
		gint _tmp27_;
		const gchar* res = NULL;
		gsize _tmp28_;
		void* _tmp29_;
		void* ptr = NULL;
		const gchar* _tmp30_;
		const gchar* _tmp31_;
		void* _tmp32_;
		const gchar* _tmp45_;
		len = (gsize) 1;
		{
			gboolean _tmp4_ = FALSE;
			i = 0;
			_tmp4_ = TRUE;
			while (TRUE) {
				gboolean _tmp6_ = FALSE;
				gboolean _tmp7_ = FALSE;
				gint _tmp12_ = 0;
				gint _tmp13_;
				const gchar* _tmp14_;
				gsize _tmp19_;
				if (!_tmp4_) {
					gint _tmp5_;
					_tmp5_ = i;
					i = _tmp5_ + 1;
				}
				_tmp4_ = FALSE;
				if (str_array_length1 != -1) {
					gint _tmp8_;
					_tmp8_ = i;
					_tmp7_ = _tmp8_ < str_array_length1;
				} else {
					_tmp7_ = FALSE;
				}
				if (_tmp7_) {
					_tmp6_ = TRUE;
				} else {
					gboolean _tmp9_ = FALSE;
					if (str_array_length1 == -1) {
						gint _tmp10_;
						const gchar* _tmp11_;
						_tmp10_ = i;
						_tmp11_ = str_array[_tmp10_];
						_tmp9_ = _tmp11_ != NULL;
					} else {
						_tmp9_ = FALSE;
					}
					_tmp6_ = _tmp9_;
				}
				if (!_tmp6_) {
					break;
				}
				_tmp13_ = i;
				_tmp14_ = str_array[_tmp13_];
				if (_tmp14_ != NULL) {
					gint _tmp15_;
					const gchar* _tmp16_;
					gint _tmp17_;
					gint _tmp18_;
					_tmp15_ = i;
					_tmp16_ = str_array[_tmp15_];
					_tmp17_ = strlen ((const gchar*) _tmp16_);
					_tmp18_ = _tmp17_;
					_tmp12_ = _tmp18_;
				} else {
					_tmp12_ = 0;
				}
				_tmp19_ = len;
				len = _tmp19_ + _tmp12_;
			}
		}
		_tmp20_ = i;
		if (_tmp20_ == 0) {
			gchar* _tmp21_;
			_tmp21_ = g_strdup ("");
			result = _tmp21_;
			return result;
		}
		_tmp22_ = i;
		str_array_length1 = _tmp22_;
		_tmp23_ = str_array_length1;
		_tmp24_ = len;
		_tmp25_ = strlen ((const gchar*) separator);
		_tmp26_ = _tmp25_;
		_tmp27_ = i;
		len = _tmp24_ + (_tmp26_ * (_tmp27_ - 1));
		_tmp28_ = len;
		_tmp29_ = g_malloc (_tmp28_);
		res = _tmp29_;
		_tmp30_ = res;
		_tmp31_ = str_array[0];
		_tmp32_ = g_stpcpy ((void*) _tmp30_, (const gchar*) _tmp31_);
		ptr = _tmp32_;
		{
			gboolean _tmp33_ = FALSE;
			i = 1;
			_tmp33_ = TRUE;
			while (TRUE) {
				gint _tmp35_;
				void* _tmp36_;
				void* _tmp37_;
				const gchar* _tmp38_ = NULL;
				gint _tmp39_;
				const gchar* _tmp40_;
				void* _tmp43_;
				void* _tmp44_;
				if (!_tmp33_) {
					gint _tmp34_;
					_tmp34_ = i;
					i = _tmp34_ + 1;
				}
				_tmp33_ = FALSE;
				_tmp35_ = i;
				if (!(_tmp35_ < str_array_length1)) {
					break;
				}
				_tmp36_ = ptr;
				_tmp37_ = g_stpcpy (_tmp36_, (const gchar*) separator);
				ptr = _tmp37_;
				_tmp39_ = i;
				_tmp40_ = str_array[_tmp39_];
				if (_tmp40_ != NULL) {
					gint _tmp41_;
					const gchar* _tmp42_;
					_tmp41_ = i;
					_tmp42_ = str_array[_tmp41_];
					_tmp38_ = (const gchar*) _tmp42_;
				} else {
					_tmp38_ = "";
				}
				_tmp43_ = ptr;
				_tmp44_ = g_stpcpy (_tmp43_, _tmp38_);
				ptr = _tmp44_;
			}
		}
		_tmp45_ = res;
		res = NULL;
		result = (gchar*) _tmp45_;
		return result;
	} else {
		gchar* _tmp46_;
		_tmp46_ = g_strdup ("");
		result = _tmp46_;
		return result;
	}
}


static gchar*
desktop_weather_get_css (DesktopWeather* self)
{
	gchar* result = NULL;
	gchar** currcolor = NULL;
	GSettings* _tmp0_;
	gchar** _tmp1_;
	gchar** _tmp2_;
	gint currcolor_length1;
	gint _currcolor_size_;
	gchar* temp_css = NULL;
	const gchar* _tmp3_;
	gchar** _tmp4_;
	gint _tmp4__length1;
	gchar* _tmp5_;
	gchar* _tmp6_;
	gchar* _tmp7_;
	gchar* _tmp8_;
	gchar* _tmp9_;
	gchar* _tmp10_;
	gchar* bigfont = NULL;
	gchar* _tmp11_;
	gchar* smallfont = NULL;
	gchar* _tmp12_;
	gint _tmp13_;
	const gchar* _tmp20_;
	const gchar* _tmp21_;
	gchar* _tmp22_;
	gchar* _tmp23_;
	const gchar* _tmp24_;
	gchar* _tmp25_;
	gchar* _tmp26_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->desktop_settings;
	_tmp2_ = _tmp1_ = g_settings_get_strv (_tmp0_, "textcolor");
	currcolor = _tmp2_;
	currcolor_length1 = _vala_array_length (_tmp1_);
	_currcolor_size_ = currcolor_length1;
	_tmp3_ = self->priv->css_template;
	_tmp4_ = currcolor;
	_tmp4__length1 = currcolor_length1;
	_tmp5_ = _vala_g_strjoinv (", ", _tmp4_, _tmp4__length1);
	_tmp6_ = _tmp5_;
	_tmp7_ = g_strconcat ("rgb(", _tmp6_, ")", NULL);
	_tmp8_ = _tmp7_;
	_tmp9_ = string_replace (_tmp3_, "xxx-xxx-xxx", _tmp8_);
	_tmp10_ = _tmp9_;
	_g_free0 (_tmp8_);
	_g_free0 (_tmp6_);
	temp_css = _tmp10_;
	_tmp11_ = g_strdup ("20");
	bigfont = _tmp11_;
	_tmp12_ = g_strdup ("15");
	smallfont = _tmp12_;
	_tmp13_ = self->priv->currscale;
	switch (_tmp13_) {
		case 1:
		{
			gchar* _tmp14_;
			gchar* _tmp15_;
			_tmp14_ = g_strdup ("25");
			_g_free0 (bigfont);
			bigfont = _tmp14_;
			_tmp15_ = g_strdup ("17");
			_g_free0 (smallfont);
			smallfont = _tmp15_;
			break;
		}
		case 2:
		{
			gchar* _tmp16_;
			gchar* _tmp17_;
			_tmp16_ = g_strdup ("37");
			_g_free0 (bigfont);
			bigfont = _tmp16_;
			_tmp17_ = g_strdup ("22");
			_g_free0 (smallfont);
			smallfont = _tmp17_;
			break;
		}
		case 3:
		{
			gchar* _tmp18_;
			gchar* _tmp19_;
			_tmp18_ = g_strdup ("50");
			_g_free0 (bigfont);
			bigfont = _tmp18_;
			_tmp19_ = g_strdup ("32");
			_g_free0 (smallfont);
			smallfont = _tmp19_;
			break;
		}
		default:
		break;
	}
	_tmp20_ = temp_css;
	_tmp21_ = bigfont;
	_tmp22_ = string_replace (_tmp20_, "bigfont", _tmp21_);
	_tmp23_ = _tmp22_;
	_tmp24_ = smallfont;
	_tmp25_ = string_replace (_tmp23_, "smallfont", _tmp24_);
	_tmp26_ = _tmp25_;
	_g_free0 (_tmp23_);
	result = _tmp26_;
	_g_free0 (smallfont);
	_g_free0 (bigfont);
	_g_free0 (temp_css);
	currcolor = (_vala_array_free (currcolor, currcolor_length1, (GDestroyNotify) g_free), NULL);
	return result;
}


static gint
desktop_weather_get_stringindex (DesktopWeather* self,
                                 const gchar* s,
                                 gchar** arr,
                                 int arr_length1)
{
	gint result = 0;
	g_return_val_if_fail (self != NULL, 0);
	g_return_val_if_fail (s != NULL, 0);
	{
		gint i = 0;
		i = 0;
		{
			gboolean _tmp0_ = FALSE;
			_tmp0_ = TRUE;
			while (TRUE) {
				gint _tmp2_;
				gint _tmp3_;
				const gchar* _tmp4_;
				if (!_tmp0_) {
					gint _tmp1_;
					_tmp1_ = i;
					i = _tmp1_ + 1;
				}
				_tmp0_ = FALSE;
				_tmp2_ = i;
				if (!(_tmp2_ < arr_length1)) {
					break;
				}
				_tmp3_ = i;
				_tmp4_ = arr[_tmp3_];
				if (g_strcmp0 (s, _tmp4_) == 0) {
					result = i;
					return result;
				}
			}
		}
	}
	result = -1;
	return result;
}


static GdkPixbuf**
_vala_array_dup1 (GdkPixbuf** self,
                  int length)
{
	GdkPixbuf** result;
	int i;
	result = g_new0 (GdkPixbuf*, length + 1);
	for (i = 0; i < length; i++) {
		GdkPixbuf* _tmp0_;
		_tmp0_ = _g_object_ref0 (self[i]);
		result[i] = _tmp0_;
	}
	return result;
}


static GdkPixbuf**
_vala_array_dup2 (GdkPixbuf** self,
                  int length)
{
	GdkPixbuf** result;
	int i;
	result = g_new0 (GdkPixbuf*, length + 1);
	for (i = 0; i < length; i++) {
		GdkPixbuf* _tmp0_;
		_tmp0_ = _g_object_ref0 (self[i]);
		result[i] = _tmp0_;
	}
	return result;
}


static GdkPixbuf**
_vala_array_dup3 (GdkPixbuf** self,
                  int length)
{
	GdkPixbuf** result;
	int i;
	result = g_new0 (GdkPixbuf*, length + 1);
	for (i = 0; i < length; i++) {
		GdkPixbuf* _tmp0_;
		_tmp0_ = _g_object_ref0 (self[i]);
		result[i] = _tmp0_;
	}
	return result;
}


static void
_vala_array_add1 (gchar** * array,
                  int* length,
                  int* size,
                  gchar* value)
{
	if ((*length) == (*size)) {
		*size = (*size) ? (2 * (*size)) : 4;
		*array = g_renew (gchar*, *array, (*size) + 1);
	}
	(*array)[(*length)++] = value;
	(*array)[*length] = NULL;
}


static gchar*
string_strip (const gchar* self)
{
	gchar* result = NULL;
	gchar* _result_ = NULL;
	gchar* _tmp0_;
	const gchar* _tmp1_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = g_strdup (self);
	_result_ = _tmp0_;
	_tmp1_ = _result_;
	g_strstrip (_tmp1_);
	result = _result_;
	return result;
}


static void
desktop_weather_update_content (DesktopWeather* self)
{
	GdkPixbuf** currimages = NULL;
	GdkPixbuf** _tmp0_;
	gint currimages_length1;
	gint _currimages_size_;
	gint _tmp1_;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = g_new0 (GdkPixbuf*, 0 + 1);
	currimages = _tmp0_;
	currimages_length1 = 0;
	_currimages_size_ = currimages_length1;
	_tmp1_ = self->priv->currscale;
	switch (_tmp1_) {
		case 1:
		{
			GdkPixbuf** _tmp2_;
			gint _tmp2__length1;
			GdkPixbuf** _tmp3_;
			gint _tmp3__length1;
			_tmp2_ = self->priv->iconpixbufs_1;
			_tmp2__length1 = self->priv->iconpixbufs_1_length1;
			_tmp3_ = (_tmp2_ != NULL) ? _vala_array_dup1 (_tmp2_, _tmp2__length1) : ((gpointer) _tmp2_);
			_tmp3__length1 = _tmp2__length1;
			currimages = (_vala_array_free (currimages, currimages_length1, (GDestroyNotify) g_object_unref), NULL);
			currimages = _tmp3_;
			currimages_length1 = _tmp3__length1;
			_currimages_size_ = currimages_length1;
			break;
		}
		case 2:
		{
			GdkPixbuf** _tmp4_;
			gint _tmp4__length1;
			GdkPixbuf** _tmp5_;
			gint _tmp5__length1;
			_tmp4_ = self->priv->iconpixbufs_2;
			_tmp4__length1 = self->priv->iconpixbufs_2_length1;
			_tmp5_ = (_tmp4_ != NULL) ? _vala_array_dup2 (_tmp4_, _tmp4__length1) : ((gpointer) _tmp4_);
			_tmp5__length1 = _tmp4__length1;
			currimages = (_vala_array_free (currimages, currimages_length1, (GDestroyNotify) g_object_unref), NULL);
			currimages = _tmp5_;
			currimages_length1 = _tmp5__length1;
			_currimages_size_ = currimages_length1;
			break;
		}
		case 3:
		{
			GdkPixbuf** _tmp6_;
			gint _tmp6__length1;
			GdkPixbuf** _tmp7_;
			gint _tmp7__length1;
			_tmp6_ = self->priv->iconpixbufs_3;
			_tmp6__length1 = self->priv->iconpixbufs_3_length1;
			_tmp7_ = (_tmp6_ != NULL) ? _vala_array_dup3 (_tmp6_, _tmp6__length1) : ((gpointer) _tmp6_);
			_tmp7__length1 = _tmp6__length1;
			currimages = (_vala_array_free (currimages, currimages_length1, (GDestroyNotify) g_object_unref), NULL);
			currimages = _tmp7_;
			currimages_length1 = _tmp7__length1;
			_currimages_size_ = currimages_length1;
			break;
		}
		default:
		break;
	}
	{
		GFileInputStream* _tmp8_ = NULL;
		GFile* _tmp9_;
		GFileInputStream* _tmp10_;
		GDataInputStream* dis = NULL;
		GDataInputStream* _tmp11_;
		gchar* line = NULL;
		gchar** weatherlines = NULL;
		gchar** _tmp12_;
		gint weatherlines_length1;
		gint _weatherlines_size_;
		gchar* newicon = NULL;
		gchar** _tmp21_;
		gint _tmp21__length1;
		const gchar* _tmp22_;
		gchar* _tmp23_;
		gchar* _tmp24_;
		gchar** _tmp25_;
		gint _tmp25__length1;
		const gchar* _tmp26_;
		gchar* _tmp27_;
		gchar* _tmp28_;
		gint ic_index = 0;
		const gchar* _tmp29_;
		gchar** _tmp30_;
		gint _tmp30__length1;
		GtkImage* _tmp31_;
		GdkPixbuf** _tmp32_;
		gint _tmp32__length1;
		gint _tmp33_;
		GdkPixbuf* _tmp34_;
		gint n_lines = 0;
		gchar** _tmp35_;
		gint _tmp35__length1;
		gchar* weathersection = NULL;
		gchar** _tmp36_;
		gint _tmp36__length1;
		gint _tmp37_;
		gchar* _tmp38_;
		GtkLabel* _tmp39_;
		gchar** _tmp40_;
		gint _tmp40__length1;
		const gchar* _tmp41_;
		gchar* _tmp42_;
		gchar* _tmp43_;
		GtkLabel* _tmp44_;
		const gchar* _tmp45_;
		_tmp9_ = self->priv->datasrc;
		_tmp10_ = g_file_read (_tmp9_, NULL, &_inner_error_);
		_tmp8_ = _tmp10_;
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			goto __catch2_g_error;
		}
		_tmp11_ = g_data_input_stream_new ((GInputStream*) _tmp8_);
		dis = _tmp11_;
		_tmp12_ = g_new0 (gchar*, 0 + 1);
		weatherlines = _tmp12_;
		weatherlines_length1 = 0;
		_weatherlines_size_ = weatherlines_length1;
		while (TRUE) {
			gchar* _tmp13_ = NULL;
			GDataInputStream* _tmp14_;
			gchar* _tmp15_;
			gchar* _tmp16_;
			const gchar* _tmp17_;
			gchar** _tmp18_;
			gint _tmp18__length1;
			const gchar* _tmp19_;
			gchar* _tmp20_;
			_tmp14_ = dis;
			_tmp15_ = g_data_input_stream_read_line (_tmp14_, NULL, NULL, &_inner_error_);
			_tmp13_ = _tmp15_;
			if (G_UNLIKELY (_inner_error_ != NULL)) {
				weatherlines = (_vala_array_free (weatherlines, weatherlines_length1, (GDestroyNotify) g_free), NULL);
				_g_free0 (line);
				_g_object_unref0 (dis);
				_g_object_unref0 (_tmp8_);
				goto __catch2_g_error;
			}
			_tmp16_ = _tmp13_;
			_tmp13_ = NULL;
			_g_free0 (line);
			line = _tmp16_;
			_tmp17_ = line;
			if (!(_tmp17_ != NULL)) {
				_g_free0 (_tmp13_);
				break;
			}
			_tmp18_ = weatherlines;
			_tmp18__length1 = weatherlines_length1;
			_tmp19_ = line;
			_tmp20_ = g_strdup (_tmp19_);
			_vala_array_add1 (&weatherlines, &weatherlines_length1, &_weatherlines_size_, _tmp20_);
			_g_free0 (_tmp13_);
		}
		_tmp21_ = weatherlines;
		_tmp21__length1 = weatherlines_length1;
		_tmp22_ = _tmp21_[0];
		_tmp23_ = desktop_weather_find_mappedid (self, _tmp22_);
		_tmp24_ = _tmp23_;
		_tmp25_ = weatherlines;
		_tmp25__length1 = weatherlines_length1;
		_tmp26_ = _tmp25_[1];
		_tmp27_ = g_strconcat (_tmp24_, _tmp26_, NULL);
		_tmp28_ = _tmp27_;
		_g_free0 (_tmp24_);
		newicon = _tmp28_;
		_tmp29_ = newicon;
		_tmp30_ = self->priv->iconnames;
		_tmp30__length1 = self->priv->iconnames_length1;
		ic_index = desktop_weather_get_stringindex (self, _tmp29_, _tmp30_, _tmp30__length1);
		_tmp31_ = self->priv->weather_image;
		_tmp32_ = currimages;
		_tmp32__length1 = currimages_length1;
		_tmp33_ = ic_index;
		_tmp34_ = _tmp32_[_tmp33_];
		gtk_image_set_from_pixbuf (_tmp31_, _tmp34_);
		_tmp35_ = weatherlines;
		_tmp35__length1 = weatherlines_length1;
		n_lines = _tmp35__length1;
		_tmp36_ = weatherlines;
		_tmp36__length1 = weatherlines_length1;
		_tmp37_ = n_lines;
		_tmp38_ = _vala_g_strjoinv ("\n", _tmp36_ + 3, _tmp37_ - 3);
		weathersection = _tmp38_;
		_tmp39_ = self->priv->locationlabel;
		_tmp40_ = weatherlines;
		_tmp40__length1 = weatherlines_length1;
		_tmp41_ = _tmp40_[2];
		_tmp42_ = string_strip (_tmp41_);
		_tmp43_ = _tmp42_;
		gtk_label_set_label (_tmp39_, _tmp43_);
		_g_free0 (_tmp43_);
		_tmp44_ = self->priv->weatherlabel;
		_tmp45_ = weathersection;
		gtk_label_set_label (_tmp44_, _tmp45_);
		_g_free0 (weathersection);
		_g_free0 (newicon);
		weatherlines = (_vala_array_free (weatherlines, weatherlines_length1, (GDestroyNotify) g_free), NULL);
		_g_free0 (line);
		_g_object_unref0 (dis);
		_g_object_unref0 (_tmp8_);
	}
	goto __finally2;
	__catch2_g_error:
	{
		GError* e = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		_g_error_free0 (e);
	}
	__finally2:
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		currimages = (_vala_array_free (currimages, currimages_length1, (GDestroyNotify) g_object_unref), NULL);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
	currimages = (_vala_array_free (currimages, currimages_length1, (GDestroyNotify) g_object_unref), NULL);
}


static void
desktop_weather_update_style (DesktopWeather* self)
{
	gchar* _tmp0_;
	GtkLabel* _tmp1_;
	GtkStyleContext* _tmp2_;
	GtkLabel* _tmp3_;
	GtkStyleContext* _tmp4_;
	GtkCssProvider* _tmp5_;
	const gchar* _tmp6_;
	GtkLabel* _tmp7_;
	GtkStyleContext* _tmp8_;
	GtkLabel* _tmp9_;
	GtkStyleContext* _tmp10_;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = desktop_weather_get_css (self);
	_g_free0 (self->priv->css_data);
	self->priv->css_data = _tmp0_;
	_tmp1_ = self->priv->weatherlabel;
	_tmp2_ = gtk_widget_get_style_context ((GtkWidget*) _tmp1_);
	gtk_style_context_remove_class (_tmp2_, "label");
	_tmp3_ = self->priv->locationlabel;
	_tmp4_ = gtk_widget_get_style_context ((GtkWidget*) _tmp3_);
	gtk_style_context_remove_class (_tmp4_, "biglabel");
	_tmp5_ = self->priv->css_provider;
	_tmp6_ = self->priv->css_data;
	gtk_css_provider_load_from_data (_tmp5_, _tmp6_, (gssize) -1, &_inner_error_);
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
	_tmp7_ = self->priv->locationlabel;
	_tmp8_ = gtk_widget_get_style_context ((GtkWidget*) _tmp7_);
	gtk_style_context_add_class (_tmp8_, "biglabel");
	_tmp9_ = self->priv->weatherlabel;
	_tmp10_ = gtk_widget_get_style_context ((GtkWidget*) _tmp9_);
	gtk_style_context_add_class (_tmp10_, "label");
}


static gchar*
desktop_weather_find_mappedid (DesktopWeather* self,
                               const gchar* icon_id)
{
	gchar* result = NULL;
	gchar** replacements = NULL;
	gchar* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_;
	gchar* _tmp5_;
	gchar* _tmp6_;
	gchar* _tmp7_;
	gchar* _tmp8_;
	gchar* _tmp9_;
	gchar* _tmp10_;
	gchar* _tmp11_;
	gchar* _tmp12_;
	gchar* _tmp13_;
	gchar* _tmp14_;
	gchar* _tmp15_;
	gchar* _tmp16_;
	gchar* _tmp17_;
	gchar* _tmp18_;
	gchar* _tmp19_;
	gchar* _tmp20_;
	gchar* _tmp21_;
	gchar* _tmp22_;
	gchar* _tmp23_;
	gchar* _tmp24_;
	gchar* _tmp25_;
	gchar* _tmp26_;
	gchar* _tmp27_;
	gchar* _tmp28_;
	gchar* _tmp29_;
	gchar* _tmp30_;
	gchar* _tmp31_;
	gchar* _tmp32_;
	gchar* _tmp33_;
	gchar* _tmp34_;
	gchar* _tmp35_;
	gchar* _tmp36_;
	gchar* _tmp37_;
	gchar* _tmp38_;
	gchar* _tmp39_;
	gchar* _tmp40_;
	gchar* _tmp41_;
	gchar** _tmp42_;
	gint replacements_length1;
	gint replacements_length2;
	gint lenrep = 0;
	gchar** _tmp43_;
	gint _tmp43__length1;
	gint _tmp43__length2;
	gint _tmp44_;
	gchar* _tmp56_;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (icon_id != NULL, NULL);
	_tmp0_ = g_strdup ("221");
	_tmp1_ = g_strdup ("212");
	_tmp2_ = g_strdup ("231");
	_tmp3_ = g_strdup ("230");
	_tmp4_ = g_strdup ("232");
	_tmp5_ = g_strdup ("230");
	_tmp6_ = g_strdup ("301");
	_tmp7_ = g_strdup ("300");
	_tmp8_ = g_strdup ("302");
	_tmp9_ = g_strdup ("300");
	_tmp10_ = g_strdup ("310");
	_tmp11_ = g_strdup ("300");
	_tmp12_ = g_strdup ("312");
	_tmp13_ = g_strdup ("311");
	_tmp14_ = g_strdup ("314");
	_tmp15_ = g_strdup ("313");
	_tmp16_ = g_strdup ("502");
	_tmp17_ = g_strdup ("501");
	_tmp18_ = g_strdup ("503");
	_tmp19_ = g_strdup ("501");
	_tmp20_ = g_strdup ("504");
	_tmp21_ = g_strdup ("501");
	_tmp22_ = g_strdup ("522");
	_tmp23_ = g_strdup ("521");
	_tmp24_ = g_strdup ("531");
	_tmp25_ = g_strdup ("521");
	_tmp26_ = g_strdup ("622");
	_tmp27_ = g_strdup ("621");
	_tmp28_ = g_strdup ("711");
	_tmp29_ = g_strdup ("701");
	_tmp30_ = g_strdup ("721");
	_tmp31_ = g_strdup ("701");
	_tmp32_ = g_strdup ("731");
	_tmp33_ = g_strdup ("701");
	_tmp34_ = g_strdup ("741");
	_tmp35_ = g_strdup ("701");
	_tmp36_ = g_strdup ("751");
	_tmp37_ = g_strdup ("701");
	_tmp38_ = g_strdup ("761");
	_tmp39_ = g_strdup ("701");
	_tmp40_ = g_strdup ("762");
	_tmp41_ = g_strdup ("701");
	_tmp42_ = g_new0 (gchar*, (21 * 2) + 1);
	_tmp42_[0] = _tmp0_;
	_tmp42_[1] = _tmp1_;
	_tmp42_[2] = _tmp2_;
	_tmp42_[3] = _tmp3_;
	_tmp42_[4] = _tmp4_;
	_tmp42_[5] = _tmp5_;
	_tmp42_[6] = _tmp6_;
	_tmp42_[7] = _tmp7_;
	_tmp42_[8] = _tmp8_;
	_tmp42_[9] = _tmp9_;
	_tmp42_[10] = _tmp10_;
	_tmp42_[11] = _tmp11_;
	_tmp42_[12] = _tmp12_;
	_tmp42_[13] = _tmp13_;
	_tmp42_[14] = _tmp14_;
	_tmp42_[15] = _tmp15_;
	_tmp42_[16] = _tmp16_;
	_tmp42_[17] = _tmp17_;
	_tmp42_[18] = _tmp18_;
	_tmp42_[19] = _tmp19_;
	_tmp42_[20] = _tmp20_;
	_tmp42_[21] = _tmp21_;
	_tmp42_[22] = _tmp22_;
	_tmp42_[23] = _tmp23_;
	_tmp42_[24] = _tmp24_;
	_tmp42_[25] = _tmp25_;
	_tmp42_[26] = _tmp26_;
	_tmp42_[27] = _tmp27_;
	_tmp42_[28] = _tmp28_;
	_tmp42_[29] = _tmp29_;
	_tmp42_[30] = _tmp30_;
	_tmp42_[31] = _tmp31_;
	_tmp42_[32] = _tmp32_;
	_tmp42_[33] = _tmp33_;
	_tmp42_[34] = _tmp34_;
	_tmp42_[35] = _tmp35_;
	_tmp42_[36] = _tmp36_;
	_tmp42_[37] = _tmp37_;
	_tmp42_[38] = _tmp38_;
	_tmp42_[39] = _tmp39_;
	_tmp42_[40] = _tmp40_;
	_tmp42_[41] = _tmp41_;
	replacements = _tmp42_;
	replacements_length1 = 21;
	replacements_length2 = 2;
	_tmp43_ = replacements;
	_tmp43__length1 = replacements_length1;
	_tmp43__length2 = replacements_length2;
	_tmp44_ = _tmp43__length1;
	lenrep = _tmp44_;
	{
		gint i = 0;
		i = 0;
		{
			gboolean _tmp45_ = FALSE;
			_tmp45_ = TRUE;
			while (TRUE) {
				gint _tmp47_;
				gint _tmp48_;
				gchar** _tmp49_;
				gint _tmp49__length1;
				gint _tmp49__length2;
				gint _tmp50_;
				const gchar* _tmp51_;
				if (!_tmp45_) {
					gint _tmp46_;
					_tmp46_ = i;
					i = _tmp46_ + 1;
				}
				_tmp45_ = FALSE;
				_tmp47_ = i;
				_tmp48_ = lenrep;
				if (!(_tmp47_ < _tmp48_)) {
					break;
				}
				_tmp49_ = replacements;
				_tmp49__length1 = replacements_length1;
				_tmp49__length2 = replacements_length2;
				_tmp50_ = i;
				_tmp51_ = _tmp49_[(_tmp50_ * _tmp49__length2) + 0];
				if (g_strcmp0 (icon_id, _tmp51_) == 0) {
					gchar** _tmp52_;
					gint _tmp52__length1;
					gint _tmp52__length2;
					gint _tmp53_;
					const gchar* _tmp54_;
					gchar* _tmp55_;
					_tmp52_ = replacements;
					_tmp52__length1 = replacements_length1;
					_tmp52__length2 = replacements_length2;
					_tmp53_ = i;
					_tmp54_ = _tmp52_[(_tmp53_ * _tmp52__length2) + 1];
					_tmp55_ = g_strdup (_tmp54_);
					result = _tmp55_;
					replacements = (_vala_array_free (replacements, replacements_length1 * replacements_length2, (GDestroyNotify) g_free), NULL);
					return result;
				}
			}
		}
	}
	_tmp56_ = g_strdup (icon_id);
	result = _tmp56_;
	replacements = (_vala_array_free (replacements, replacements_length1 * replacements_length2, (GDestroyNotify) g_free), NULL);
	return result;
}


static gchar*
string_slice (const gchar* self,
              glong start,
              glong end)
{
	gchar* result = NULL;
	glong string_length = 0L;
	gint _tmp0_;
	gint _tmp1_;
	gboolean _tmp4_ = FALSE;
	gboolean _tmp6_ = FALSE;
	gchar* _tmp8_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = strlen (self);
	_tmp1_ = _tmp0_;
	string_length = (glong) _tmp1_;
	if (start < ((glong) 0)) {
		glong _tmp2_;
		_tmp2_ = string_length;
		start = _tmp2_ + start;
	}
	if (end < ((glong) 0)) {
		glong _tmp3_;
		_tmp3_ = string_length;
		end = _tmp3_ + end;
	}
	if (start >= ((glong) 0)) {
		glong _tmp5_;
		_tmp5_ = string_length;
		_tmp4_ = start <= _tmp5_;
	} else {
		_tmp4_ = FALSE;
	}
	g_return_val_if_fail (_tmp4_, NULL);
	if (end >= ((glong) 0)) {
		glong _tmp7_;
		_tmp7_ = string_length;
		_tmp6_ = end <= _tmp7_;
	} else {
		_tmp6_ = FALSE;
	}
	g_return_val_if_fail (_tmp6_, NULL);
	g_return_val_if_fail (start <= end, NULL);
	_tmp8_ = g_strndup (((gchar*) self) + start, (gsize) (end - start));
	result = _tmp8_;
	return result;
}


static void
_vala_array_add2 (gchar** * array,
                  int* length,
                  int* size,
                  gchar* value)
{
	if ((*length) == (*size)) {
		*size = (*size) ? (2 * (*size)) : 4;
		*array = g_renew (gchar*, *array, (*size) + 1);
	}
	(*array)[(*length)++] = value;
	(*array)[*length] = NULL;
}


static void
_vala_array_add3 (GdkPixbuf** * array,
                  int* length,
                  int* size,
                  GdkPixbuf* value)
{
	if ((*length) == (*size)) {
		*size = (*size) ? (2 * (*size)) : 4;
		*array = g_renew (GdkPixbuf*, *array, (*size) + 1);
	}
	(*array)[(*length)++] = value;
	(*array)[*length] = NULL;
}


static void
_vala_array_add4 (GdkPixbuf** * array,
                  int* length,
                  int* size,
                  GdkPixbuf* value)
{
	if ((*length) == (*size)) {
		*size = (*size) ? (2 * (*size)) : 4;
		*array = g_renew (GdkPixbuf*, *array, (*size) + 1);
	}
	(*array)[(*length)++] = value;
	(*array)[*length] = NULL;
}


static void
_vala_array_add5 (GdkPixbuf** * array,
                  int* length,
                  int* size,
                  GdkPixbuf* value)
{
	if ((*length) == (*size)) {
		*size = (*size) ? (2 * (*size)) : 4;
		*array = g_renew (GdkPixbuf*, *array, (*size) + 1);
	}
	(*array)[(*length)++] = value;
	(*array)[*length] = NULL;
}


static void
desktop_weather_get_icondata (DesktopWeather* self)
{
	gchar* icondir = NULL;
	gchar* _tmp0_;
	gchar** _tmp1_;
	GdkPixbuf** _tmp2_;
	GdkPixbuf** _tmp3_;
	GdkPixbuf** _tmp4_;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = g_strconcat ("/", "usr/lib/budgie-desktop/plugins", "/budgie-weathershow/weather_icons", NULL);
	icondir = _tmp0_;
	_tmp1_ = g_new0 (gchar*, 0 + 1);
	self->priv->iconnames = (_vala_array_free (self->priv->iconnames, self->priv->iconnames_length1, (GDestroyNotify) g_free), NULL);
	self->priv->iconnames = _tmp1_;
	self->priv->iconnames_length1 = 0;
	self->priv->_iconnames_size_ = self->priv->iconnames_length1;
	_tmp2_ = g_new0 (GdkPixbuf*, 0 + 1);
	self->priv->iconpixbufs_1 = (_vala_array_free (self->priv->iconpixbufs_1, self->priv->iconpixbufs_1_length1, (GDestroyNotify) g_object_unref), NULL);
	self->priv->iconpixbufs_1 = _tmp2_;
	self->priv->iconpixbufs_1_length1 = 0;
	self->priv->_iconpixbufs_1_size_ = self->priv->iconpixbufs_1_length1;
	_tmp3_ = g_new0 (GdkPixbuf*, 0 + 1);
	self->priv->iconpixbufs_2 = (_vala_array_free (self->priv->iconpixbufs_2, self->priv->iconpixbufs_2_length1, (GDestroyNotify) g_object_unref), NULL);
	self->priv->iconpixbufs_2 = _tmp3_;
	self->priv->iconpixbufs_2_length1 = 0;
	self->priv->_iconpixbufs_2_size_ = self->priv->iconpixbufs_2_length1;
	_tmp4_ = g_new0 (GdkPixbuf*, 0 + 1);
	self->priv->iconpixbufs_3 = (_vala_array_free (self->priv->iconpixbufs_3, self->priv->iconpixbufs_3_length1, (GDestroyNotify) g_object_unref), NULL);
	self->priv->iconpixbufs_3 = _tmp4_;
	self->priv->iconpixbufs_3_length1 = 0;
	self->priv->_iconpixbufs_3_size_ = self->priv->iconpixbufs_3_length1;
	{
		GDir* dr = NULL;
		const gchar* _tmp5_;
		GDir* _tmp6_;
		gchar* filename = NULL;
		_tmp5_ = icondir;
		_tmp6_ = g_dir_open (_tmp5_, (guint) 0, &_inner_error_);
		dr = _tmp6_;
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			if (_inner_error_->domain == G_FILE_ERROR) {
				goto __catch3_g_file_error;
			}
			_g_free0 (icondir);
			g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return;
		}
		filename = NULL;
		while (TRUE) {
			GDir* _tmp7_;
			const gchar* _tmp8_;
			gchar* _tmp9_;
			const gchar* _tmp10_;
			gchar** _tmp11_;
			gint _tmp11__length1;
			const gchar* _tmp12_;
			gchar* _tmp13_;
			gchar* iconpath = NULL;
			const gchar* _tmp14_;
			const gchar* _tmp15_;
			gchar* _tmp16_;
			GdkPixbuf* _tmp17_ = NULL;
			const gchar* _tmp18_;
			GdkPixbuf* _tmp19_;
			GdkPixbuf** _tmp20_;
			gint _tmp20__length1;
			GdkPixbuf* _tmp21_;
			GdkPixbuf* _tmp22_ = NULL;
			const gchar* _tmp23_;
			GdkPixbuf* _tmp24_;
			GdkPixbuf** _tmp25_;
			gint _tmp25__length1;
			GdkPixbuf* _tmp26_;
			GdkPixbuf* _tmp27_ = NULL;
			const gchar* _tmp28_;
			GdkPixbuf* _tmp29_;
			GdkPixbuf** _tmp30_;
			gint _tmp30__length1;
			GdkPixbuf* _tmp31_;
			_tmp7_ = dr;
			_tmp8_ = g_dir_read_name (_tmp7_);
			_tmp9_ = g_strdup (_tmp8_);
			_g_free0 (filename);
			filename = _tmp9_;
			_tmp10_ = filename;
			if (!(_tmp10_ != NULL)) {
				break;
			}
			_tmp11_ = self->priv->iconnames;
			_tmp11__length1 = self->priv->iconnames_length1;
			_tmp12_ = filename;
			_tmp13_ = string_slice (_tmp12_, (glong) 0, (glong) 4);
			_vala_array_add2 (&self->priv->iconnames, &self->priv->iconnames_length1, &self->priv->_iconnames_size_, _tmp13_);
			_tmp14_ = icondir;
			_tmp15_ = filename;
			_tmp16_ = g_build_filename (_tmp14_, _tmp15_, NULL);
			iconpath = _tmp16_;
			_tmp18_ = iconpath;
			_tmp19_ = gdk_pixbuf_new_from_file_at_size (_tmp18_, 150, 150, &_inner_error_);
			_tmp17_ = _tmp19_;
			if (G_UNLIKELY (_inner_error_ != NULL)) {
				_g_free0 (iconpath);
				_g_free0 (filename);
				_g_dir_close0 (dr);
				if (_inner_error_->domain == G_FILE_ERROR) {
					goto __catch3_g_file_error;
				}
				goto __finally3;
			}
			_tmp20_ = self->priv->iconpixbufs_1;
			_tmp20__length1 = self->priv->iconpixbufs_1_length1;
			_tmp21_ = _tmp17_;
			_tmp17_ = NULL;
			_vala_array_add3 (&self->priv->iconpixbufs_1, &self->priv->iconpixbufs_1_length1, &self->priv->_iconpixbufs_1_size_, _tmp21_);
			_tmp23_ = iconpath;
			_tmp24_ = gdk_pixbuf_new_from_file_at_size (_tmp23_, 220, 220, &_inner_error_);
			_tmp22_ = _tmp24_;
			if (G_UNLIKELY (_inner_error_ != NULL)) {
				_g_object_unref0 (_tmp17_);
				_g_free0 (iconpath);
				_g_free0 (filename);
				_g_dir_close0 (dr);
				if (_inner_error_->domain == G_FILE_ERROR) {
					goto __catch3_g_file_error;
				}
				goto __finally3;
			}
			_tmp25_ = self->priv->iconpixbufs_2;
			_tmp25__length1 = self->priv->iconpixbufs_2_length1;
			_tmp26_ = _tmp22_;
			_tmp22_ = NULL;
			_vala_array_add4 (&self->priv->iconpixbufs_2, &self->priv->iconpixbufs_2_length1, &self->priv->_iconpixbufs_2_size_, _tmp26_);
			_tmp28_ = iconpath;
			_tmp29_ = gdk_pixbuf_new_from_file_at_size (_tmp28_, 320, 320, &_inner_error_);
			_tmp27_ = _tmp29_;
			if (G_UNLIKELY (_inner_error_ != NULL)) {
				_g_object_unref0 (_tmp22_);
				_g_object_unref0 (_tmp17_);
				_g_free0 (iconpath);
				_g_free0 (filename);
				_g_dir_close0 (dr);
				if (_inner_error_->domain == G_FILE_ERROR) {
					goto __catch3_g_file_error;
				}
				goto __finally3;
			}
			_tmp30_ = self->priv->iconpixbufs_3;
			_tmp30__length1 = self->priv->iconpixbufs_3_length1;
			_tmp31_ = _tmp27_;
			_tmp27_ = NULL;
			_vala_array_add5 (&self->priv->iconpixbufs_3, &self->priv->iconpixbufs_3_length1, &self->priv->_iconpixbufs_3_size_, _tmp31_);
			_g_object_unref0 (_tmp27_);
			_g_object_unref0 (_tmp22_);
			_g_object_unref0 (_tmp17_);
			_g_free0 (iconpath);
		}
		_g_free0 (filename);
		_g_dir_close0 (dr);
	}
	goto __finally3;
	__catch3_g_file_error:
	{
		GError* err = NULL;
		err = _inner_error_;
		_inner_error_ = NULL;
		g_print ("Something went wrong loading the icons");
		_g_error_free0 (err);
	}
	__finally3:
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		_g_free0 (icondir);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
	_g_free0 (icondir);
}


static void
_gtk_main_quit_gtk_widget_destroy (GtkWidget* _sender,
                                   gpointer self)
{
	gtk_main_quit ();
}


void
desktop_weather_main (gchar** args,
                      int args_length1)
{
	GtkWindow* win = NULL;
	DesktopWeather* _tmp0_;
	gtk_init (&args_length1, &args);
	_tmp0_ = desktop_weather_new ();
	g_object_ref_sink (_tmp0_);
	win = (GtkWindow*) _tmp0_;
	gtk_window_set_decorated (win, FALSE);
	gtk_widget_show_all ((GtkWidget*) win);
	g_signal_connect ((GtkWidget*) win, "destroy", (GCallback) _gtk_main_quit_gtk_widget_destroy, NULL);
	gtk_main ();
	_g_object_unref0 (win);
}


int
main (int argc,
      char ** argv)
{
	desktop_weather_main (argv, argc);
	return 0;
}


static void
desktop_weather_class_init (DesktopWeatherClass * klass)
{
	desktop_weather_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (DesktopWeatherPrivate));
	G_OBJECT_CLASS (klass)->finalize = desktop_weather_finalize;
}


static void
desktop_weather_instance_init (DesktopWeather * self)
{
	gchar** _tmp0_;
	self->priv = DESKTOP_WEATHER_GET_PRIVATE (self);
	_tmp0_ = g_new0 (gchar*, 0 + 1);
	self->priv->iconnames = _tmp0_;
	self->priv->iconnames_length1 = 0;
	self->priv->_iconnames_size_ = self->priv->iconnames_length1;
}


static void
desktop_weather_finalize (GObject * obj)
{
	DesktopWeather * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, TYPE_DESKTOP_WEATHER, DesktopWeather);
	_g_object_unref0 (self->priv->datasrc);
	_g_object_unref0 (self->priv->monitor);
	_g_object_unref0 (self->priv->maingrid);
	_g_object_unref0 (self->priv->locationlabel);
	_g_object_unref0 (self->priv->weatherlabel);
	_g_object_unref0 (self->priv->desktop_settings);
	_g_free0 (self->priv->css_data);
	_g_free0 (self->priv->css_template);
	_g_object_unref0 (self->priv->css_provider);
	self->priv->iconpixbufs_1 = (_vala_array_free (self->priv->iconpixbufs_1, self->priv->iconpixbufs_1_length1, (GDestroyNotify) g_object_unref), NULL);
	self->priv->iconpixbufs_2 = (_vala_array_free (self->priv->iconpixbufs_2, self->priv->iconpixbufs_2_length1, (GDestroyNotify) g_object_unref), NULL);
	self->priv->iconpixbufs_3 = (_vala_array_free (self->priv->iconpixbufs_3, self->priv->iconpixbufs_3_length1, (GDestroyNotify) g_object_unref), NULL);
	self->priv->iconnames = (_vala_array_free (self->priv->iconnames, self->priv->iconnames_length1, (GDestroyNotify) g_free), NULL);
	_g_object_unref0 (self->priv->weather_image);
	G_OBJECT_CLASS (desktop_weather_parent_class)->finalize (obj);
}


GType
desktop_weather_get_type (void)
{
	static volatile gsize desktop_weather_type_id__volatile = 0;
	if (g_once_init_enter (&desktop_weather_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (DesktopWeatherClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) desktop_weather_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (DesktopWeather), 0, (GInstanceInitFunc) desktop_weather_instance_init, NULL };
		GType desktop_weather_type_id;
		desktop_weather_type_id = g_type_register_static (gtk_window_get_type (), "DesktopWeather", &g_define_type_info, 0);
		g_once_init_leave (&desktop_weather_type_id__volatile, desktop_weather_type_id);
	}
	return desktop_weather_type_id__volatile;
}


static void
_vala_array_destroy (gpointer array,
                     gint array_length,
                     GDestroyNotify destroy_func)
{
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void
_vala_array_free (gpointer array,
                  gint array_length,
                  GDestroyNotify destroy_func)
{
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}


static gint
_vala_array_length (gpointer array)
{
	int length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}



